# Identifier-centric queries: Account, ENSName, 8004Identity (→ Agent)
#
# Ontology prefixes:
# - agentictrust-core: https://www.agentictrust.io/ontology/agentictrust-core#
# - agentictrust-eth:  https://www.agentictrust.io/ontology/agentictrust-eth#
# - ERC8004:           https://www.agentictrust.io/ontology/ERC8004#

PREFIX agentictrust: <https://www.agentictrust.io/ontology/agentictrust-core#>
PREFIX agentictrustEth: <https://www.agentictrust.io/ontology/agentictrust-eth#>
PREFIX erc8004: <https://www.agentictrust.io/ontology/ERC8004#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

################################################################################
# 1) Agent → AccountIdentifier → Account (+ DID)
################################################################################

SELECT ?agent ?agentId ?accountIdentifier ?account ?chainId ?address ?accountType ?did
WHERE {
  ?agent a agentictrust:AIAgent .
  OPTIONAL { ?agent agentictrust:agentId ?agentId . }

  # Preferred, explicit path
  ?agent agentictrustEth:hasAccountIdentifier ?accountIdentifier .
  OPTIONAL { ?accountIdentifier agentictrust:hasDID ?did . }

  ?accountIdentifier agentictrustEth:hasAccount ?account .
  OPTIONAL { ?account agentictrustEth:accountChainId ?chainId . }
  OPTIONAL { ?account agentictrustEth:accountAddress ?address . }
  OPTIONAL { ?account agentictrustEth:accountType ?accountType . }
}
ORDER BY ?agentId

################################################################################
# 2) Agent → ENSName → ENSNameIdentifier (+ DID)
################################################################################

SELECT ?agent ?agentId ?ensName ?ensNameValue ?ensIdentifier ?did
WHERE {
  ?agent a agentictrust:AIAgent .
  OPTIONAL { ?agent agentictrust:agentId ?agentId . }

  ?agent agentictrustEth:hasENSName ?ensName .
  OPTIONAL { ?ensName agentictrustEth:ensName ?ensNameValue . }

  ?ensName agentictrustEth:hasIdentifier ?ensIdentifier .
  OPTIONAL { ?ensIdentifier rdfs:label ?ensNameValue . }
  OPTIONAL { ?ensIdentifier agentictrust:hasDID ?did . }
}
ORDER BY ?agentId

################################################################################
# 3) Agent → 8004Identity → 8004IdentityIdentifier (+ DID)
################################################################################

SELECT ?agent ?agentId ?identity8004 ?identityIdentifier ?did
WHERE {
  ?agent a agentictrust:AIAgent .
  OPTIONAL { ?agent agentictrust:agentId ?agentId . }

  ?agent erc8004:has8004Identity ?identity8004 .
  ?identity8004 agentictrust:hasIdentifier ?identityIdentifier .
  OPTIONAL { ?identityIdentifier agentictrust:hasDID ?did . }
}
ORDER BY ?agentId

################################################################################
# 4) One row per agent: Account + ENS + 8004Identity (all OPTIONAL)
################################################################################

SELECT ?agent ?agentId
  ?accountIdentifier ?account ?chainId ?address
  ?ensName ?ensNameValue ?ensIdentifier
  ?identity8004 ?identityIdentifier
WHERE {
  ?agent a agentictrust:AIAgent .
  OPTIONAL { ?agent agentictrust:agentId ?agentId . }

  OPTIONAL {
    ?agent agentictrustEth:hasAccountIdentifier ?accountIdentifier .
    ?accountIdentifier agentictrustEth:hasAccount ?account .
    OPTIONAL { ?account agentictrustEth:accountChainId ?chainId . }
    OPTIONAL { ?account agentictrustEth:accountAddress ?address . }
  }

  OPTIONAL {
    ?agent agentictrustEth:hasENSName ?ensName .
    OPTIONAL { ?ensName agentictrustEth:ensName ?ensNameValue . }
    OPTIONAL { ?ensName agentictrustEth:hasIdentifier ?ensIdentifier . }
  }

  OPTIONAL {
    ?agent erc8004:has8004Identity ?identity8004 .
    OPTIONAL { ?identity8004 agentictrust:hasIdentifier ?identityIdentifier . }
  }
}
ORDER BY ?agentId


