# Identifier-centric queries: Account, NameENS, Identity8004 (→ Agent)
#
# Ontology prefixes:
# - agentictrust-core: https://agentictrust.io/ontology/core#
# - agentictrust-eth:  https://agentictrust.io/ontology/eth#
# - ERC8004:           https://agentictrust.io/ontology/erc8004#

PREFIX core: <https://agentictrust.io/ontology/core#>
PREFIX eth: <https://agentictrust.io/ontology/eth#>
PREFIX erc8004: <https://agentictrust.io/ontology/erc8004#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

################################################################################
# 1) Agent → AccountIdentifier → Account (+ DID)
################################################################################

SELECT ?agent ?agentId ?accountIdentifier ?account ?chainId ?address ?accountType ?did
WHERE {
  ?agent a core:AIAgent .
  OPTIONAL { ?agent core:agentId ?agentId . }

  # Preferred, explicit path
  ?agent eth:hasAccountIdentifier ?accountIdentifier .
  OPTIONAL { ?accountIdentifier core:hasDID ?did . }

  ?account eth:hasIdentifier ?accountIdentifier .
  OPTIONAL { ?account eth:accountChainId ?chainId . }
  OPTIONAL { ?account eth:accountAddress ?address . }
  OPTIONAL { ?account eth:accountType ?accountType . }
}
ORDER BY ?agentId

################################################################################
# 2) Agent → NameENS → NameIdentifierENS (+ DID)
################################################################################

SELECT ?agent ?agentId ?ensName ?ensNameValue ?ensIdentifier ?did
WHERE {
  ?agent a core:AIAgent .
  OPTIONAL { ?agent core:agentId ?agentId . }

  ?agent core:hasName ?ensName .
  OPTIONAL { ?ensName eth:ensName ?ensNameValue . }

  ?ensName eth:hasIdentifier ?ensIdentifier .
  OPTIONAL { ?ensIdentifier rdfs:label ?ensNameValue . }
  OPTIONAL { ?ensIdentifier core:hasDID ?did . }
}
ORDER BY ?agentId

################################################################################
# 3) Agent → Identity8004 → IdentityIdentifier8004 (+ DID)
################################################################################

SELECT ?agent ?agentId ?identity8004 ?identityIdentifier ?did
WHERE {
  ?agent a core:AIAgent .
  OPTIONAL { ?agent core:agentId ?agentId . }

  ?agent core:hasIdentity ?identity8004 .
  ?identity8004 core:hasIdentifier ?identityIdentifier .
  OPTIONAL { ?identityIdentifier core:hasDID ?did . }
}
ORDER BY ?agentId

################################################################################
# 4) One row per agent: Account + ENS + Identity8004 (all OPTIONAL)
################################################################################

SELECT ?agent ?agentId
  ?accountIdentifier ?account ?chainId ?address
  ?ensName ?ensNameValue ?ensIdentifier
  ?identity8004 ?identityIdentifier
WHERE {
  ?agent a core:AIAgent .
  OPTIONAL { ?agent core:agentId ?agentId . }

  OPTIONAL {
    ?agent eth:hasAccountIdentifier ?accountIdentifier .
    ?account eth:hasIdentifier ?accountIdentifier .
    OPTIONAL { ?account eth:accountChainId ?chainId . }
    OPTIONAL { ?account eth:accountAddress ?address . }
  }

  OPTIONAL {
    ?agent core:hasName ?ensName .
    OPTIONAL { ?ensName eth:ensName ?ensNameValue . }
    OPTIONAL { ?ensName eth:hasIdentifier ?ensIdentifier . }
  }

  OPTIONAL {
    ?agent core:hasIdentity ?identity8004 .
    OPTIONAL { ?identity8004 core:hasIdentifier ?identityIdentifier . }
  }
}
ORDER BY ?agentId


