## ERC-8004 ontology (`ERC8004.owl`)

Source: `apps/badge-admin/public/ontology/ERC8004.owl`

### Full diagram (generated)

- PNG: `docs/ontology/images/ERC8004.png`
- SVG: `docs/ontology/images/ERC8004.svg`

![ERC8004 ontology diagram](./images/ERC8004.png)

### Section diagrams

![ERC8004 registration metadata](./images/sections/erc8004-registration.png)

![ERC8004 trust records (validation + feedback)](./images/sections/erc8004-trust.png)

![ERC8004 offchain profile entities](./images/sections/erc8004-offchain.png)

### Registration metadata composition

`erc8004:AgentRegistration8004` is an ERC-8004 agent registration descriptor that extends `agentictrust:AgentDescriptor`. It contains all agent registration data extracted from agentURI registration JSON (rawJson metadata), including:

- **Endpoints** (with EndpointType): Network endpoints following URI/URL standards (RFC 3986)
- **AgentSkillClassification** (OASF): Skill classifications following OASF (Open Agent Skill Format) standards
- **AgentDomainClassification** (OASF): Domain classifications following OASF standards
- **DID**: Decentralized Identifiers following W3C DID Core specification (https://www.w3.org/TR/did-core/)
- **DomainName**: Domain names following IETF DNS standards (RFC 1034, RFC 1035)
- **TrustType**: Trust mechanism types (reputation, crypto-economic, tee, zkml, etc.)
- **TrustModel**: Trust model categories (execution-integrity/TEE, reputation, crypto-economic, social-graph, ...)
- **Name, Description, Image**: Text and image data following Unicode (UTF-8) and URI standards

```mermaid
classDiagram
direction LR

class AIAgent["agentictrust:AIAgent"]
class AgentDescriptor["agentictrust:AgentDescriptor"]
class AgentRegistration8004["erc8004:AgentRegistration8004"]
class Endpoint["agentictrust:Endpoint"]
class AgentSkillClassification["agentictrust:AgentSkillClassification"]
class AgentDomainClassification["agentictrust:AgentDomainClassification"]
class DID["agentictrust:DID"]
class DomainName["agentictrust:DomainName"]
class TrustType["agentictrust:TrustType"]
class TrustModel["agentictrust:TrustModel"]

AgentRegistration8004 --|> AgentDescriptor

AIAgent --> AgentIdentity8004 : hasIdentity
AgentIdentity8004 --> AgentRegistration8004 : hasDescriptor
AgentRegistration8004 --> Endpoint : hasEndpoint
AgentRegistration8004 --> AgentSkillClassification : hasSkill
AgentRegistration8004 --> AgentDomainClassification : hasDomain
AgentRegistration8004 --> DID : hasDID
AgentRegistration8004 --> DomainName : hasDomainName
AgentRegistration8004 --> TrustType : hasTrustType
AgentRegistration8004 --> TrustModel : hasTrustModel
AgentRegistration8004 : +descriptorName (text)
AgentRegistration8004 : +descriptorDescription (text)
AgentRegistration8004 : +descriptorImage (URI)
```

### Validation and feedback as trust model specializations (assertion-side)

```mermaid
classDiagram
direction LR

class TrustAssertion["agentictrust:TrustAssertion"]
class VerificationAssertion["agentictrust:VerificationTrustAssertion"]
class ReputationAssertion["agentictrust:ReputationTrustAssertion"]
class AIAgent["agentictrust:AIAgent"]

class ErcTrustAssertion["erc8004:TrustAssertion"]
class ValidationRequest["erc8004:ValidationRequestSituation"]
class ValidationResponse["erc8004:ValidationResponse"]
class Feedback["erc8004:Feedback"]
class FeedbackResponse["erc8004:FeedbackResponse"]

ErcTrustAssertion --|> TrustAssertion

ValidationResponse --|> ErcTrustAssertion
ValidationResponse --|> VerificationAssertion

Feedback --|> ErcTrustAssertion
Feedback --|> ReputationAssertion
FeedbackResponse --|> ErcTrustAssertion
FeedbackResponse --|> ReputationAssertion

AIAgent --> Feedback : hasFeedback
AIAgent --> ValidationResponse : hasValidation

ValidationResponse --> ValidationRequest : validationRespondsToRequest
```

### Difference between Feedback and FeedbackResponse

Both `erc8004:Feedback` and `erc8004:FeedbackResponse` are `ReputationTrustAssertion` records, but they serve different roles:

**`erc8004:Feedback`**
- Initial feedback/review submitted by a client about an agent
- Created by `erc8004:FeedbackAct`, which asserts a `ReputationTrustSituation`
- Contains: score, tags, comments, rating, etc.
- Stored in `rep_feedbacks` table

**`erc8004:FeedbackResponse`**
- Response to an existing `Feedback` record
- Used for disputes, clarifications, or additional context
- Created by `erc8004:FeedbackResponseAct`
- Stored in `rep_feedback_responses` table with a `feedbackIndex` linking back to the original feedback

**Relationship:**
- Multiple `FeedbackResponse` records can exist for a single `Feedback` record
- The database tracks responses via `feedbackIndex` in the `rep_feedback_responses` table
- The original feedback record maintains a `responseCount` field

### SPARQL Queries (demonstrating property relationships)

**Query AgentRegistration with Metadata Components:**
```sparql
PREFIX agentictrust: <https://www.agentictrust.io/ontology/agentictrust-core#>
PREFIX erc8004: <https://www.agentictrust.io/ontology/ERC8004#>

SELECT ?agent ?agentId ?agentRegistration8004 ?endpoint ?skill ?domain ?did ?domainName ?trustType ?name ?description ?image
WHERE {
  ?agent a agentictrust:AIAgent ;
    agentictrust:agentId ?agentId ;
    erc8004:hasAgentRegistration ?agentRegistration .
  
  OPTIONAL {
    ?agentRegistration erc8004:hasProtocolMetadata ?protocolMetadata .
  }
  OPTIONAL {
    ?agentRegistration erc8004:hasNameMetadata ?nameMetadata .
  }
  OPTIONAL {
    ?agentRegistration erc8004:hasSkillsMetadata ?skillsMetadata .
  }
  OPTIONAL {
    ?agentRegistration erc8004:hasIntegrationMetadata ?integrationMetadata .
  }
}
```

**Query ValidationResponse with ValidationRequestSituation:**
```sparql
PREFIX erc8004: <https://www.agentictrust.io/ontology/ERC8004#>
PREFIX agentictrust: <https://www.agentictrust.io/ontology/agentictrust-core#>

SELECT ?agent ?validationResponse ?validationRequest ?validatorAgent ?intentCheck
WHERE {
  ?agent a agentictrust:AIAgent ;
    erc8004:hasValidation ?validationResponse .
  
  ?validationResponse a erc8004:ValidationResponse .
  
  OPTIONAL {
    ?validationResponse erc8004:validationRespondsToRequest ?validationRequest .
  }
  OPTIONAL {
    ?validationResponse erc8004:validatorAgentForResponse ?validatorAgent .
  }
  OPTIONAL {
    ?validationResponse erc8004:validationTagCheck ?intentCheck .
  }
}
```

**Query Feedback with Context:**
```sparql
PREFIX erc8004: <https://www.agentictrust.io/ontology/ERC8004#>
PREFIX agentictrust: <https://www.agentictrust.io/ontology/agentictrust-core#>

SELECT ?agent ?feedback ?feedbackScore ?client ?skill ?intentType
WHERE {
  ?agent a agentictrust:AIAgent ;
    erc8004:hasFeedback ?feedback .
  
  OPTIONAL {
    ?feedback erc8004:feedbackScore ?feedbackScore .
  }
  OPTIONAL {
    ?feedback erc8004:feedbackClient ?client .
  }
  OPTIONAL {
    ?feedback erc8004:feedbackSkill ?skill .
  }
  OPTIONAL {
    ?feedback erc8004:feedbackIntentType ?intentType .
  }
}
```

**Query ProtocolMetadata with Skills:**
```sparql
PREFIX erc8004: <https://www.agentictrust.io/ontology/ERC8004#>
PREFIX agentictrust: <https://www.agentictrust.io/ontology/agentictrust-core#>

SELECT ?protocolMetadata ?skill ?skillLabel
WHERE {
  ?protocolMetadata a erc8004:ProtocolMetadata ;
    erc8004:exposesSkill ?skill .
  
  OPTIONAL {
    ?skill rdfs:label ?skillLabel .
  }
}
```

**Query SkillsMetadata with Skills:**
```sparql
PREFIX erc8004: <https://www.agentictrust.io/ontology/ERC8004#>
PREFIX agentictrust: <https://www.agentictrust.io/ontology/agentictrust-core#>

SELECT ?skillsMetadata ?skill ?skillLabel
WHERE {
  ?skillsMetadata a erc8004:SkillsMetadata ;
    erc8004:listsSkill ?skill .
  
  OPTIONAL {
    ?skill rdfs:label ?skillLabel .
  }
}
```

### Offchain profile entities (schemas, attachments, proof)

```mermaid
classDiagram
direction LR

class ValidationOffchainData["erc8004:ValidationOffchainData"]
class FeedbackOffchainData["erc8004:FeedbackOffchainData"]
class Attachment["erc8004:Attachment"]
class ValidationAttachment["erc8004:ValidationAttachment"]
class FeedbackAttachment["erc8004:FeedbackAttachment"]
class PaymentProof["erc8004:PaymentProof"]
class ValidationType["erc8004:ValidationType"]
class ParseStatus["erc8004:ParseStatus"]
class ProofFormat["erc8004:ProofFormat"]

ValidationAttachment --|> Attachment
FeedbackAttachment --|> Attachment

ValidationOffchainData --> ValidationAttachment : hasAttachment
FeedbackOffchainData --> FeedbackAttachment : hasFeedbackAttachment
FeedbackOffchainData --> PaymentProof : hasPaymentProof
ValidationOffchainData --> ValidationType : hasValidationType
ValidationOffchainData --> ParseStatus : hasParseStatus
ValidationOffchainData --> ProofFormat : hasProofFormat
```

**Query ValidationOffchainData with Attachments and Types:**
```sparql
PREFIX erc8004: <https://www.agentictrust.io/ontology/ERC8004#>

SELECT ?validationOffchainData ?validationAttachment ?validationType ?parseStatus ?proofFormat
WHERE {
  ?validationOffchainData a erc8004:ValidationOffchainData .
  
  OPTIONAL {
    ?validationOffchainData erc8004:hasAttachment ?validationAttachment .
    ?validationAttachment a erc8004:ValidationAttachment .
  }
  OPTIONAL {
    ?validationOffchainData erc8004:hasValidationType ?validationType .
  }
  OPTIONAL {
    ?validationOffchainData erc8004:hasParseStatus ?parseStatus .
  }
  OPTIONAL {
    ?validationOffchainData erc8004:hasProofFormat ?proofFormat .
  }
}
```

**Query FeedbackOffchainData with Attachments and PaymentProof:**
```sparql
PREFIX erc8004: <https://www.agentictrust.io/ontology/ERC8004#>

SELECT ?feedbackOffchainData ?feedbackAttachment ?paymentProof
WHERE {
  ?feedbackOffchainData a erc8004:FeedbackOffchainData .
  
  OPTIONAL {
    ?feedbackOffchainData erc8004:hasFeedbackAttachment ?feedbackAttachment .
    ?feedbackAttachment a erc8004:FeedbackAttachment .
  }
  OPTIONAL {
    ?feedbackOffchainData erc8004:hasPaymentProof ?paymentProof .
  }
}
```


