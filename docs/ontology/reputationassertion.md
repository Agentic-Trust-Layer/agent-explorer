## ReputationTrustAssertion

This page documents the **ReputationTrustAssertion** class hierarchy and property relationships used to represent agent feedback and reputation claims.

### Class Hierarchy

```mermaid
classDiagram
direction TB

class provActivity["prov:Activity"]
class TrustAssertion["core:TrustAssertion"]
class ReputationAssertion["core:ReputationTrustAssertion"]
class Feedback["erc8004:Feedback"]
class FeedbackResponse["erc8004:FeedbackResponse"]

provActivity <|-- TrustAssertion
TrustAssertion <|-- ReputationAssertion
ReputationAssertion <|-- Feedback
ReputationAssertion <|-- FeedbackResponse
```

**Inheritance chain:**
- `prov:Entity` (base PROV-O class)
  - `core:TrustAssertion` (durable trust claim)
    - `core:ReputationTrustAssertion` (reputation/feedback claim)
      - `erc8004:Feedback` (ERC-8004 feedback record)
      - `erc8004:FeedbackResponse` (response to feedback)

### Property Relationships

```mermaid
classDiagram
direction LR

class AIAgent["core:AIAgent"]
class ReputationAssertion["core:ReputationTrustAssertion"]
class Feedback["erc8004:Feedback"]
class FeedbackResponse["erc8004:FeedbackResponse"]
class provAgent["prov:Agent"]
class Skill["core:AgentSkillClassification"]
class IntentType["core:IntentType"]

AIAgent --> ReputationAssertion : hasReputationAssertion (core)
AIAgent --> Feedback : hasFeedback (erc8004)

Feedback --> provAgent : feedbackClient (erc8004)
Feedback --> Skill : feedbackSkill (erc8004)
Feedback --> IntentType : feedbackIntentType (erc8004)
```

### Core Properties

#### Agent â†’ Assertion Links

- **`core:hasReputationAssertion`** (domain: `prov:Agent`, range: `core:ReputationTrustAssertion`)
  - Links an agent to reputation assertions about it or produced by it
  - Subproperty of `core:hasTrustAssertion`

- **`erc8004:hasFeedback`** (domain: `core:AIAgent`, range: `erc8004:Feedback`)
  - ERC-8004 specific property linking agents to feedback records
  - Subproperty of `core:hasReputationAssertion`

#### Feedback Context Links

- **`erc8004:feedbackClient`** (domain: `erc8004:Feedback`, range: `prov:Agent`)
  - Links feedback to the client/agent that provided it

- **`erc8004:feedbackSkill`** (domain: `erc8004:Feedback`, range: `core:AgentSkillClassification`)
  - Links feedback to the skill it relates to

- **`erc8004:feedbackIntentType`** (domain: `erc8004:Feedback`, range: `core:IntentType`)
  - Links feedback to the intent type it relates to

### Datatype Properties

**Feedback properties:**
- `erc8004:feedbackIndex` (xsd:integer) - Feedback index
- `erc8004:feedbackScore` (xsd:integer) - Feedback score
- `erc8004:feedbackRatingPct` (xsd:integer) - Rating percentage
- `erc8004:isRevoked` (xsd:boolean) - Whether feedback is revoked

**FeedbackResponse properties:**
- Similar structure for response records

### Usage Pattern

**Query all reputation assertions for an agent:**
```sparql
PREFIX core: <https://agentictrust.io/ontology/core#>
PREFIX erc8004: <https://agentictrust.io/ontology/erc8004#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT ?agent ?did8004 (xsd:integer(REPLACE(STR(?did8004), "^did:8004:[0-9]+:", "")) AS ?agentId8004) ?reputationAssertion ?feedbackScore
WHERE {
  ?agent a core:AIAgent ;
    core:hasReputationAssertion ?reputationAssertion .
  
  ?reputationAssertion a core:ReputationTrustAssertion .
  
  OPTIONAL {
    ?agent core:hasIdentity ?identity8004 .
    ?identity8004 a erc8004:AgentIdentity8004 ;
                  core:hasIdentifier ?ident8004 .
    ?ident8004 core:protocolIdentifier ?did8004 .
  }
  OPTIONAL {
    ?reputationAssertion erc8004:feedbackScore ?feedbackScore .
  }
}
```

**Query feedback with context (client, skill, intent):**
```sparql
PREFIX erc8004: <https://agentictrust.io/ontology/erc8004#>
PREFIX core: <https://agentictrust.io/ontology/core#>

SELECT ?agent ?feedback ?feedbackScore ?client ?skill ?intentType
WHERE {
  ?agent erc8004:hasFeedback ?feedback .
  
  ?feedback erc8004:feedbackScore ?feedbackScore .
  
  OPTIONAL {
    ?feedback erc8004:feedbackClient ?client .
  }
  OPTIONAL {
    ?feedback erc8004:feedbackSkill ?skill .
  }
  OPTIONAL {
    ?feedback erc8004:feedbackIntentType ?intentType .
  }
}
```

**Query average feedback score per agent:**
```sparql
PREFIX erc8004: <https://agentictrust.io/ontology/erc8004#>

SELECT ?agent (AVG(?score) AS ?avgScore) (COUNT(?feedback) AS ?feedbackCount)
WHERE {
  ?agent erc8004:hasFeedback ?feedback .
  ?feedback erc8004:feedbackScore ?score .
  FILTER(?score > 0)
}
GROUP BY ?agent
ORDER BY DESC(?avgScore)
```

### Related Concepts

- **TrustAssertion**: ReputationAssertion is a subclass of TrustAssertion
- **Skill**: Feedback can be linked to specific skills via `feedbackSkill`
- **IntentType**: Feedback can be linked to intent types via `feedbackIntentType`
- **TrustSituation**: Feedback may be generated by trust situations
- See also: [ERC-8004 documentation](./erc8004.md), [Situation](./situation.md), [Skills and Intents](./skills-intents-tasks.md)

